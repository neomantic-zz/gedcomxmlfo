<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>gedcom55XMLtoXSL-FO.xsl</title><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><style xmlns="" type="text/css">
.screen {
	font-family: monospace;
	border: thin black dotted;
	padding: .5em;
	background-color: #E0E0E0;
}
pre {
 overflow-x: auto; /* Use horizontal scroller if needed; for Firefox 2, not needed in Firefox 3 */
 white-space: pre-wrap; /* css-3 */
 white-space: -moz-pre-wrap !important; /* Mozilla, since 1999 */
 white-space: -pre-wrap; /* Opera 4-6 */
 white-space: -o-pre-wrap; /* Opera 7 */
 /* width: 99%; */
 word-wrap: break-word; /* Internet Explorer 5.5+ */
}
</style></head><body><div class="article" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="id2479782"></a>gedcom55XMLtoXSL-FO.xsl</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Chad</span> <span class="surname">Albers</span></h3></div></div>August 8, 2008 </div><hr /></div><div class="sect1" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2520810"></a>1. Overview</h2></div></div></div><p><code class="filename">gedcom55XMLtoXSL-FO.xsl</code> is an <a class="ulink" href="http://www.w3.org/Style/XSL/" target="_top">Extensible Stylesheet Language</a> (XSL) stylesheet that uses <a class="ulink" href="http://www.w3.org/TR/xslt" target="_top">XSLT</a> to transform a <a class="ulink" href="http://www.neomantic.com/gedcom55XML/" target="_top">GEDCOM 5.5 XML</a> document to a <a class="ulink" href="http://www.w3.org/TR/xsl/" target="_top">XSL-FO</a> stylesheet. This stylesheet can be converted to a <a class="ulink" href="http://www.adobe.com/devnet/pdf/pdf_reference.html" target="_top">Portable Document Format</a> (PDF) file using <a class="ulink" href="http://xmlgraphics.apache.org/fop/" target="_top">Apache's Formatting Objects Processor</a> Java application., <code class="literal">fop</code>. The pdf document resembles genealogy record keeping forms produced by <a class="ulink" href="http://www.progenealogists.com/" target="_top">ProGenealogists</a>. They specifically resemble the forms called “<a class="ulink" href="http://www.progenealogists.com/familygroup1" target="_top">Family Group Sheet Page 1</a>” and “<a class="ulink" href="http://www.progenealogists.com/familygroup2.pdf" target="_top">Family Group Sheet Page 2</a>”.</p><div class="sect2" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="id2516658"></a>1.1. Stylesheet Parameters</h3></div></div></div><p>Several parameters can be supplied to XSLT processors which affect the data included in the document and the document's “look and feel.”</p><div class="sect3" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id2517120"></a>1.1.1. Output Data Parameters</h4></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>IncludeIDs - accepts either 'true' or 'false' and acts as a flag to include the XREF ID numbers of family record elements (FAM) and the individual family member elements (INDI), including the spouses of children</p></li><li><p>IncludeDateGenerated - accepts either 'true or 'false'. If 'true', the date that the XSLT processor applied this stylesheet to a GEDCOM 5.5 XML document is included in the footer of the pdf document. This parameter relies on the http://exslt.org/dates-and-times extension. If the XSLT processor does not support this extension, the stylesheet may fail to be applied to the XML document. To be on the safe side, this parameter defaults to 'false.'</p></li><li><p>FamID - accepts the XREF ID of one FAM element. If this value is supplied, the stylesheet will produce a document containing only the family record whose ID makes the FamID parameter. If this parameter is not supplied, the stylesheet is applied to all FAM elements in the XML document. </p></li><li><p>SortFamilies - accepts either 'true or 'false'. If the IDs of the FAM elements are structured in a way that can be sorted in ascending or descending order, this parameter tells the stylesheet to sort these IDs and output the families in that order. It defaults to 'false'. </p></li></ul></div></div><div class="sect3" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id2480396"></a>1.1.2. Look and Feel Parameters</h4></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>BorderLineStyle - this parameter allows the user to determine the look of the borders in the tables, rows, and cells. It defaults to 'solid', but could accept the following values: none, hidden, dotted, dashed, double, groove, ridge, inset, and outset. Use these values with caution. The stylesheet has been designed assuming solid borders. </p></li><li><p>BorderLineWidth - this parameter enables the width of the borders to be set. It defaults to .3mm. Supply this parameter with caution. The stylesheet has been designed assuming the default value.</p></li></ul></div></div></div><div class="sect2" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="id2480419"></a>1.2. Stylesheet Versions and Download Locations</h3></div></div></div><p>The stylesheet described in this document is version 0.1. It is strictly speaking a beta version.</p><div class="itemizedlist"><ul type="disc"><li><p>Both the stylesheet and this documentation is located at <a class="ulink" href="http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/gedcom55XMLtoXSL-FO.tar.gz" target="_top">http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/gedcom55XMLtoXSL-FO.tar.gz</a>. </p></li><li><p>For verification purposes, I have signed this tar, gzipped archive with my <a class="ulink" href="gnupg" target="_top">gnupg</a> public key located <a class="ulink" href="http://www.neomantic.com/gnupg/pubkey.asc" target="_top">here</a>. The signature of <code class="filename">gedcom55XMLtoXSL-FO.tar.gz</code> is located at <a class="ulink" href="http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/gedcom55XMLtoXSL-FO.tar.gz.sign" target="_top">http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/gedcom55XMLtoXSL-FO.tar.gz.sign</a>.</p></li></ul></div></div><div class="sect2" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="id2480470"></a>1.3. Stylesheet License</h3></div></div></div><p>The source code for is released under the <a class="ulink" href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html" target="_top">GNU General Public License Version 2</a> (GPL). The full text of this license can be found in a file called “<code class="filename">gpl-2.0</code>” in <code class="filename">gedcom55XMLtoXSL-FO.tar.gz</code>.</p></div><div class="sect2" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="id2480497"></a>1.4. Stylesheet Updates</h3></div></div></div><p>Hyperlinks to the most up-to-date version of the stylesheet will be posted to <a class="ulink" href="http://www.neomantic.com" target="_top">http://www.neomantic.com</a>.</p></div></div><div class="sect1" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2480512"></a>2. Usage Instructions</h2></div></div></div><p>The process of converting a GEDCOM 5.5 file into a pdf document which resembles the progenealogists.com forms takes three steps.</p><div class="orderedlist"><ol type="1"><li><p>Convert the GEDCOM 5.5 file to a GEDCOM 5.5 XML document.</p></li><li><p>Transform the GEDCOM 5.5 XML document to an XSL-FO stylsheet by applying the <code class="filename">gedcom55XMLtoXSL-FO.xsl</code> stylesheet to the XML document.</p></li><li><p>Process the XSL-FO stylesheet using fop.</p></li></ol></div><p>The instructions below follow several conventions: </p><div class="itemizedlist"><ul type="disc"><li><p><code class="filename">family.ged</code> represents a GEDCOM 5.5 file</p></li><li><p><code class="filename">family.xml</code> represents the <code class="filename">family.ged</code> file converted into a GEDCOM 5.5 XML document</p></li><li><p><code class="filename">family.fo</code> represents a XSL-FO document produced by applying the <code class="filename">gedcom55XMLtoXSL-FO.xsl</code> XSLT stylesheet</p></li><li><p><code class="filename">family.pdf </code>represents the pdf file that resembles the progenealogist's forms</p></li><li><p>Text sandwiched between brackets [ ] indicates variables that depend upon your computer's environment</p></li></ul></div><div class="sect2" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="id2480604"></a>2.1. Convert the GEDCOM 5.5 File to a GEDCOM 5.5 XML Document</h3></div></div></div><p>To perform the conversion, use a Java application released by Michael H. Kay that converts GEDCOM 5.5 files into what he calls a “<a class="ulink" href="http://homepage.ntlworld.com/michael.h.kay/gedml/" target="_top">GedML</a>” XML documents. GedML is similar to GEDCOM 5.5 XML. See this <a class="ulink" href="http://www.neomantic.com/gedcom55XML/0.1/README.html#id2515344" target="_top">link</a> for details.</p><div class="orderedlist"><ol type="1"><li><p>Download Kay's <a class="ulink" href="http://homepage.ntlworld.com/michael.h.kay/gedml/" target="_top">source code</a> and unzip it in a location of your choosing. Remember the path to this location. It will be referred to in the last step using the variable <code class="literal">[path-to-gedml-classes]</code>.</p></li><li><p>Find the files called “<code class="filename">GedcomParser.java</code>” and “<code class="filename">GedcomToXml.xsl</code>” in Kay's source code.</p></li><li><p>Compile the file <code class="filename">GedcomParser.java</code> using your favorite Java distribution's compiler - <code class="literal">javac</code>. This will produce a class file called “<code class="filename">GedcomParser.class</code>”. The command is as follows:</p><pre class="screen"><span class="command"><strong>javac GedcomParser.java</strong></span></pre></li><li><p>Download Kay's <code class="literal"><a class="ulink" href="http://saxon.sourceforge.net/" target="_top">saxon</a></code> parser, install it, and remember its location. Its location will be referred to below using the <code class="literal">[path-to-saxon]</code> variable. (It may already be installed on your system; in the Debian GNU/Linux distribution it is located at <code class="literal">/usr/share/java/saxon.jar</code>.)</p></li><li><p>Convert <code class="filename">family.ged</code> to <code class="filename">family.xml</code> by issuing the following command in your terminal:</p><pre class="screen"><span class="command"><strong>java -cp [path-to-saxon]/saxon.jar:[path-to-gedml-classes] com.icl.saxon.StyleSheet -x GedcomParser -o family.xml family.ged [path-to-gedml-classes]/GedcomToXml.xsl</strong></span></pre></li></ol></div><p>The output of this command, <code class="filename">family.xml</code>, will be a near perfect reproduction of a GEDCOM 5.5 into GEDCOM 5.5 XML. </p></div><div class="sect2" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="id2479949"></a>2.2. Transform the GEDCOM 5.5 XML Document to an XSL-FO stylsheet</h3></div></div></div><p>To perform the transformation, the <code class="filename">gedcom55XMLtoXSL-FO.xsl</code> stylesheet must be applied to <code class="filename">family.xml</code> using an XSLT processor. I have used two command line applications to perform this transformation: <code class="literal"><a class="ulink" href="http://xmlsoft.org/XSLT/xsltproc2.html" target="_top">xsltproc</a></code> and <code class="literal">saxon</code>. <code class="literal">xsltproc</code> uses the Open Source XML parser called “<code class="literal"><a class="ulink" href="http://xmlsoft.org/" target="_top">libxml</a></code>” and is included in many GNU/Linux distributions. <a class="ulink" href="SAXON" target="_top">SAXON</a> is the XSLT processor developed by Michael H. Kay, used in the previous step.</p><p>The <code class="filename">gedcom55XMLtoXSL-FO.xsl</code> stylesheet parameters described above can be supplied to both XSLT processors. Please consult their respective documentation to find out how to do so.</p><p>NOTE: Both <code class="literal">xsltproc</code> and <code class="literal">saxon</code> may fail to transform extremely large GEDCOM 5.5 XML files due to your either your computer's or the Java virtual machine's memory limitations. To get around these limitations, the <code class="literal">saxon</code> processor works best because java's memory usage can be manipulated. See the instructions below.</p><div class="sect3" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id2480048"></a>2.2.1. xsltproc</h4></div></div></div><p>To use <code class="filename">xsltproc</code>, issue the following command in a terminal:</p><pre class="screen"><span class="command"><strong>jxsltproc gedcom55toXSL-FO.xsl family.xml &gt; family.fo</strong></span></pre></div><div class="sect3" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h4 class="title"><a id="id2480074"></a>2.2.2. SAXON</h4></div></div></div><p>To use <code class="filename">saxon</code>, issue the following command in a terminal:</p><pre class="screen"><span class="command"><strong>java -cp [path-to-saxon]/saxon.jar com.icl.saxon.StyleSheet -o family.fo family.xml gedcom55toXSL-FO.xsl</strong></span></pre><p>As mentioned above, if the <code class="filename">family.xml</code> file is extremely large, this command may fail due to Java's default memory settings. To increase the memory used by the Java's virtual machine, simply add these two flags to the command line: - “<code class="literal">-Xms -Xmx</code>”- and adjust the memory by supplying a value like 512m for each flag.</p></div></div><div class="sect2" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="id2480892"></a>2.3. Process the XSL-FO Stylesheet Using fop</h3></div></div></div><p>The outcome of the previous step is an XSL-FO document called <code class="filename">family.fo</code>. This file now needs to be processed by <code class="literal">fop</code> to produce the pdf document. To do so, follow these steps:</p><div class="orderedlist"><ol type="1"><li><p>Follow the <code class="literal">fop</code> “quickstart” guide <a class="ulink" href="http://xmlgraphics.apache.org/fop/quickstartguide.html" target="_top">here</a> to download and install <code class="literal">fop</code> or use your GNU/Linux distribution's package management system to install it.</p></li><li><p>Once installed, issue the following command in a terminal:</p></li></ol></div><pre class="screen"><span class="command"><strong>fop -fo family.fo -pdf family.pdf</strong></span></pre><p>The output of this command is the <code class="filename">family.pdf</code> file. </p></div><div class="sect2" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="id2480964"></a>2.4. Sample</h3></div></div></div><p>Included with the stylesheet and this documentation is a pdf sample of the output. It is based on a GEDCOM 5.5 file called “royal92.ged” which contains this genealogical history of the British royal family. This GEDCOM 5.5 can be easily found on the web.</p></div></div><div class="sect1" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2480884"></a>3. Documentation License</h2></div></div></div><p>This document is released under the <a class="ulink" href="http://www.gnu.org/licenses/fdl.html" target="_top">GNU Free Documentation License Version 1.2</a>. The full text of this license is found in the file called “<code class="filename">fdl.txt</code>” released with <code class="filename">gedcom55XMLtoXSL-FO.tar.gz</code>. It can also be located at <a class="ulink" href="http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/README.html" target="_top">http://www.neomantic.com/downlads/gedcom55XMLtoXSL-FO/README.html</a>. </p></div><div class="sect1" lang="en-US" xml:lang="en-US"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2481012"></a>4. Contact</h2></div></div></div><p>Please direct questions or requests for more information to <code class="email">&lt;<a class="email" href="mailto:chad@neomantic.com">chad@neomantic.com</a>&gt;</code>. Corrections, suggestions, bug reports, and patches are welcome as well.</p></div></div></body></html>
