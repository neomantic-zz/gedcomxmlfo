<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML//EN" "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">

<!-- XML file was created by LyX 1.5.5
  See http://www.lyx.org/ for more information -->
<article lang="en_US">
<articleinfo>
<title>gedcom55XMLtoXSL-FO.xsl</title>
<date>August 8, 2008 </date><author>
<firstname>Chad</firstname><surname>Albers</surname></author></articleinfo><sect1>
<title>Overview</title>
<para><filename>gedcom55XMLtoXSL-FO.xsl</filename> is an <ulink url="http://www.w3.org/Style/XSL/">Extensible Stylesheet Language</ulink> (XSL) stylesheet that uses <ulink url="http://www.w3.org/TR/xslt">XSLT</ulink> to transform a <ulink url="http://www.neomantic.com/gedcom55XML/">GEDCOM 5.5 XML</ulink> document to a <ulink url="http://www.w3.org/TR/xsl/">XSL-FO</ulink> stylesheet. This stylesheet can be converted to a <ulink url="http://www.adobe.com/devnet/pdf/pdf_reference.html">Portable Document Format</ulink> (PDF) file using <ulink url="http://xmlgraphics.apache.org/fop/">Apache's Formatting Objects Processor</ulink> Java application., <literal>fop</literal>. The pdf document resembles genealogy record keeping forms produced by <ulink url="http://www.progenealogists.com/">ProGenealogists</ulink>. They specifically resemble the forms called &ldquo;<ulink url="http://www.progenealogists.com/familygroup1">Family Group Sheet Page 1</ulink>&rdquo; and &ldquo;<ulink url="http://www.progenealogists.com/familygroup2.pdf">Family Group Sheet Page 2</ulink>&rdquo;.</para><sect2>
<title>Stylesheet Parameters</title>
<para>Several parameters can be supplied to XSLT processors which affect the data included in the document and the document's &ldquo;look and feel.&rdquo;</para><sect3>
<title>Output Data Parameters</title>
<itemizedlist>
<listitem><para>IncludeIDs - accepts either 'true' or 'false' and acts as a flag to include the XREF ID numbers of family record elements (FAM) and the individual family member elements (INDI), including the spouses of children</para></listitem><listitem><para>IncludeDateGenerated - accepts either 'true or 'false'. If 'true', the date that the XSLT processor applied this stylesheet to a GEDCOM 5.5 XML document is included in the footer of the pdf document. This parameter relies on the http://exslt.org/dates-and-times extension. If the XSLT processor does not support this extension, the stylesheet may fail to be applied to the XML document. To be on the safe side, this parameter defaults to 'false.'</para></listitem><listitem><para>FamID - accepts the XREF ID of one FAM element. If this value is supplied, the stylesheet will produce a document containing only the family record whose ID makes the FamID parameter. If this parameter is not supplied, the stylesheet is applied to all FAM elements in the XML document. </para></listitem><listitem><para>SortFamilies - accepts either 'true or 'false'. If the IDs of the FAM elements are structured in a way that can be sorted in ascending or descending order, this parameter tells the stylesheet to sort these IDs and output the families in that order. It defaults to 'false'. </para></listitem></itemizedlist></sect3><sect3>
<title>Look and Feel Parameters</title>
<itemizedlist>
<listitem><para>BorderLineStyle - this parameter allows the user to determine the look of the borders in the tables, rows, and cells. It defaults to 'solid', but could accept the following values: none, hidden, dotted, dashed, double, groove, ridge, inset, and outset. Use these values with caution. The stylesheet has been designed assuming solid borders. </para></listitem><listitem><para>BorderLineWidth - this parameter enables the width of the borders to be set. It defaults to .3mm. Supply this parameter with caution. The stylesheet has been designed assuming the default value.</para></listitem></itemizedlist></sect3></sect2><sect2>
<title>Stylesheet Versions and Download Locations</title>
<para>The stylesheet described in this document is version 0.1. It is strictly speaking a beta version.</para><itemizedlist>
<listitem><para>Both the stylesheet and this documentation is located at <ulink url="http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/gedcom55XMLtoXSL-FO.tar.gz">http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/gedcom55XMLtoXSL-FO.tar.gz</ulink>. </para></listitem><listitem><para>For verification purposes, I have signed this tar, gzipped archive with my <ulink url="gnupg"></ulink> public key located <ulink url="http://www.neomantic.com/gnupg/pubkey.asc">here</ulink>. The signature of <filename>gedcom55XMLtoXSL-FO.tar.gz</filename> is located at <ulink url="http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/gedcom55XMLtoXSL-FO.tar.gz.sign">http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/gedcom55XMLtoXSL-FO.tar.gz.sign</ulink>.</para></listitem></itemizedlist></sect2><sect2>
<title>Stylesheet License</title>
<para>The source code for is released under the <ulink url="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">GNU General Public License Version 2</ulink> (GPL). The full text of this license can be found in a file called &ldquo;<filename>gpl-2.0</filename>&rdquo; in <filename>gedcom55XMLtoXSL-FO.tar.gz</filename>.</para></sect2><sect2>
<title>Stylesheet Updates</title>
<para>Hyperlinks to the most up-to-date version of the stylesheet will be posted to <ulink url="http://www.neomantic.com">http://www.neomantic.com</ulink>.</para></sect2></sect1><sect1>
<title>Usage Instructions</title>
<para>The process of converting a GEDCOM 5.5 file into a pdf document which resembles the progenealogists.com forms takes three steps.</para><orderedlist>
<listitem><para>Convert the GEDCOM 5.5 file to a GEDCOM 5.5 XML document.</para></listitem><listitem><para>Transform the GEDCOM 5.5 XML document to an XSL-FO stylsheet by applying the <filename>gedcom55XMLtoXSL-FO.xsl</filename> stylesheet to the XML document.</para></listitem><listitem><para>Process the XSL-FO stylesheet using fop.</para></listitem></orderedlist><para>The instructions below follow several conventions: </para><itemizedlist>
<listitem><para><filename>family.ged</filename> represents a GEDCOM 5.5 file</para></listitem><listitem><para><filename>family.xml</filename> represents the <filename>family.ged</filename> file converted into a GEDCOM 5.5 XML document</para></listitem><listitem><para><filename>family.fo</filename>represents a XSL-FO document produced by applying the <filename>gedcom55XMLtoXSL-FO.xsl</filename> XSLT stylesheet</para></listitem><listitem><para><filename>family.pdf </filename>represents the pdf file that resembles the progenealogist's forms</para></listitem><listitem><para>Text sandwiched between brackets [ ] indicates variables that depend upon your computer's environment</para></listitem></itemizedlist><sect2>
<title>Convert the GEDCOM 5.5 File to a GEDCOM 5.5 XML Document</title>
<para>To perform the conversion, use a Java application released by Michael H. Kay that converts GEDCOM 5.5 files into what he calls a &ldquo;<ulink url="http://homepage.ntlworld.com/michael.h.kay/gedml/">GedML</ulink>&rdquo; XML documents. GedML is similar to GEDCOM 5.5 XML. See this <ulink url="http://www.neomantic.com/gedcom55XML/0.1/README.html#id2515344">link</ulink> for details.</para><orderedlist>
<listitem><para>Download Kay's <ulink url="http://homepage.ntlworld.com/michael.h.kay/gedml/">source code</ulink> and unzip it in a location of your choosing. Remember the path to this location. It will be referred to in the last step using the variable <literal>[path-to-gedml-classes]</literal>.</para></listitem><listitem><para>Find the files called &ldquo;<filename>GedcomParser.java</filename>&rdquo; and &ldquo;<filename>GedcomToXml.xsl</filename>&rdquo; in Kay's source code.</para></listitem><listitem><para>Compile the file <filename>GedcomParser.java</filename> using your favorite Java distribution's compiler - <literal>javac</literal>. This will produce a class file called &ldquo;<filename>GedcomParser.class</filename>&rdquo;. The command is as follows:</para><screen>
<![CDATA[javac GedcomParser.java
]]></screen></listitem><listitem><para>Download Kay's <literal><ulink url="http://saxon.sourceforge.net/">saxon</ulink></literal> parser, install it, and remember its location. Its location will be referred to below using the <literal>[path-to-saxon]</literal> variable. (It may already be installed on your system; in the Debian GNU/Linux distribution it is located at <literal>/usr/share/java/saxon.jar</literal>.)</para></listitem><listitem><para>Convert <filename>family.ged</filename> to <filename>family.xml</filename> by issuing the following command in your terminal:</para><screen>
<![CDATA[java -cp [path-to-saxon]/saxon.jar:[path-to-gedml-classes] com.icl.saxon.StyleSheet -x GedcomParser -o family.xml family.ged [path-to-gedml-classes]/GedcomToXml.xsl
]]></screen></listitem></orderedlist><para>The output of this command, <filename>family.xml</filename>, will be a near perfect reproduction of a GEDCOM 5.5 into GEDCOM 5.5 XML. </para></sect2><sect2>
<title>Transform the GEDCOM 5.5 XML Document to an XSL-FO stylsheet</title>
<para>To perform the transformation, the <filename>gedcom55XMLtoXSL-FO.xsl</filename> stylesheet must be applied to <filename>family.xml</filename> using an XSLT processor. I have used two command line applications to perform this transformation: <literal><ulink url="http://xmlsoft.org/XSLT/xsltproc2.html">xsltproc</ulink></literal> and <literal>saxon</literal>. <literal>xsltproc</literal> uses the Open Source XML parser called &ldquo;<literal><ulink url="http://xmlsoft.org/">libxml</ulink></literal>&rdquo; and is included in many GNU/Linux distributions. <ulink url="SAXON"></ulink> is the XSLT processor developed by Michael H. Kay, used in the previous step.</para>
<para>The <filename>gedcom55XMLtoXSL-FO.xsl</filename> stylesheet parameters described above can be supplied to both XSLT processors. Please consult their respective documentation to find out how to do so.</para>
<para>NOTE: Both <literal>xsltproc</literal> and <literal>saxon</literal> may fail to transform extremely large GEDCOM 5.5 XML files due to your either your computer's or the Java virtual machine's memory limitations. To get around these limitations, the <literal>saxon</literal> processor works best because java's memory usage can be manipulated. See the instructions below.</para><sect3>
<title>xsltproc</title>
<para>To use <filename>xsltproc</filename>, issue the following command in a terminal:</para><screen>
<![CDATA[xsltproc gedcom55toXSL-FO.xsl family.xml > family.fo
]]></screen></sect3><sect3>
<title>SAXON</title>
<para>To use <filename>saxon</filename>, issue the following command in a terminal:</para><screen>
<![CDATA[java -cp [path-to-saxon]/saxon.jar com.icl.saxon.StyleSheet -o family.fo family.xml gedcom55toXSL-FO.xsl
]]></screen><para>As mentioned above, if the <filename>family.xml</filename> file is extremely large, this command may fail due to Java's default memory settings. To increase the memory used by the Java's virtual machine, simply add these two flags to the command line: - &ldquo;<literal>-Xms -Xmx</literal>&rdquo;- and adjust the memory by supplying a value like 512m for each flag.</para></sect3></sect2><sect2>
<title>Process the XSL-FO Stylesheet Using fop</title>
<para>The outcome of the previous step is an XSL-FO document called <filename>family.fo</filename>. This file now needs to be processed by <literal>fop</literal> to produce the pdf document. To do so, follow these steps:</para><orderedlist>
<listitem><para>Follow the <literal>fop</literal> &ldquo;quickstart&rdquo; guide <ulink url="http://xmlgraphics.apache.org/fop/quickstartguide.html">here</ulink> to download and install <literal>fop</literal> or use your GNU/Linux distribution's package management system to install it.</para></listitem><listitem><para>Once installed, issue the following command in a terminal:</para></listitem></orderedlist><screen>
<![CDATA[fop -fo family.fo -pdf family.pdf
]]></screen><para>The output of this command is the <filename>family.pdf</filename> file. Here is a hyperlink to a sample.</para></sect2></sect1><sect1>
<title>Documentation License</title>
<para>This document is released under the <ulink url="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation License Version 1.2</ulink>. The full text of this license is found in the file called &ldquo;<filename>fdl.txt</filename>&rdquo; released with <filename>gedcom55XMLtoXSL-FO.tar.gz</filename>. It can also be located at <ulink url="http://www.neomantic.com/downloads/gedcom55XMLtoXSL-FO/README.html">http://www.neomantic.com/downlads/gedcom55XMLtoXSL-FO/README.html</ulink>. </para></sect1><sect1>
<title>Contact</title>
<para>Please direct questions or requests for more information to <email>chad@neomantic.com</email>. Corrections, suggestions, bug reports, and patches are welcome as well.</para></sect1></article>